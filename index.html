<!DOCTYPE html>

<html lang="en">

<head>

Â  <meta charset="UTF-8" />

Â  <meta name="viewport" content="width=device-width, initial-scale=1" />

Â  <title>LinguaLab â€“ Practice English with AI</title>

Â  <meta name="description" content="Scenario-based English practice with AI conversations. Daily English and Workplace English." />

Â  <style>

Â  Â  :root{

Â  Â  Â  --bg:#0b1020;--card:#121936;--muted:#9aa4c7;--text:#e6e9f7;

Â  Â  Â  --accent:#6e9cff;--accent-2:#8ef0d0;--danger:#ff7a7a;--shadow:0 10px 30px rgba(0,0,0,.35);

Â  Â  Â  --radius:18px

Â  Â  }

Â  Â  *{box-sizing:border-box}

Â  Â  body{

Â  Â  Â  margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;

Â  Â  Â  background:radial-gradient(1000px 600px at 80% -10%,#1a2460,transparent),

Â  Â  Â  Â  Â  Â  Â  Â  Â radial-gradient(800px 600px at -10% 20%,#1b3b42,transparent),

Â  Â  Â  Â  Â  Â  Â  Â  Â var(--bg);color:var(--text)

Â  Â  }

Â  Â  header{position:sticky;top:0;backdrop-filter:blur(10px);background:rgba(9,11,24,.6);

Â  Â  Â  border-bottom:1px solid rgba(255,255,255,.05);z-index:50}

Â  Â  .container{max-width:1120px;margin:0 auto;padding:16px}

Â  Â  .nav{display:flex;align-items:center;justify-content:space-between;gap:16px}

Â  Â  .brand{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.3px}

Â  Â  .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:var(--shadow)}

Â  Â  .pill{padding:6px 12px;border:1px solid rgba(255,255,255,.1);border-radius:999px;color:var(--muted);font-size:14px}

Â  Â  .hero{padding:56px 16px 20px}

Â  Â  .hero-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:24px;align-items:start}

Â  Â  @media (max-width:900px){.hero-grid{grid-template-columns:1fr}}

Â  Â  .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));

Â  Â  Â  border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);box-shadow:var(--shadow)}

Â  Â  .card.pad{padding:22px}

Â  Â  h1{font-size:clamp(28px,5vw,48px);margin:0 0 10px;line-height:1.1}

Â  Â  .sub{color:var(--muted);font-size:clamp(14px,2.2vw,18px)}

Â  Â  .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:18px}

Â  Â  .stat{padding:14px;border-radius:14px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);text-align:center}

Â  Â  .stat .big{font-weight:800;font-size:22px}

Â  Â  .stat .cap{color:var(--muted);font-size:12px}

Â  Â  .scenarios{padding:26px 16px 60px}

Â  Â  .section-title{display:flex;align-items:center;justify-content:space-between;margin:18px 0 10px}

Â  Â  .grid{display:grid;grid-template-columns:repeat(5,1fr);gap:16px}

Â  Â  @media (max-width:1200px){.grid{grid-template-columns:repeat(4,1fr)}}

Â  Â  @media (max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}

Â  Â  @media (max-width:560px){.grid{grid-template-columns:1fr}}

Â  Â  .scenario{position:relative;overflow:hidden;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease}

Â  Â  .scenario:hover{transform:translateY(-4px);box-shadow:0 18px 40px rgba(0,0,0,.35)}

Â  Â  .thumb{aspect-ratio:16/11;background:#0e1430;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:center;font-size:42px}

Â  Â  .scenario h3{margin:14px 16px 6px;font-size:16px}

Â  Â  .scenario p{margin:0 16px 14px;color:var(--muted);font-size:13px}

Â  Â  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

Â  Â  .btn{appearance:none;border:0;cursor:pointer;padding:11px 14px;border-radius:12px;font-weight:700;color:#0d142e;background:linear-gradient(180deg,var(--accent),#5f7df5);box-shadow:var(--shadow)}

Â  Â  .btn.secondary{background:rgba(255,255,255,.08);color:var(--text);border:1px solid rgba(255,255,255,.1);font-weight:600}

Â  Â  .btn.ghost{background:transparent;color:var(--muted);border:1px dashed rgba(255,255,255,.2)}

Â  Â  .btn:disabled{opacity:.55;cursor:not-allowed}

Â  Â  .input{padding:11px 12px;border-radius:12px;background:rgba(255,255,255,.06);color:var(--text);border:1px solid rgba(255,255,255,.1)}

Â  Â  .input::placeholder{color:#b8c0e0}

Â  Â  .progress{height:10px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.1)}

Â  Â  .progress>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width .3s ease}

Â  Â  .notice{font-size:13px;color:var(--muted)}

Â  Â  footer.site{padding:36px 16px 60px;color:var(--muted);text-align:center}

Â  Â  .badge{font-size:12px;color:#0a122c;background:var(--accent-2);padding:4px 8px;border-radius:999px;font-weight:700}

Â  Â  /* Modal */

Â  Â  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:100}

Â  Â  .modal{width:min(100%,980px);max-height:92vh;display:grid;grid-template-rows:auto 1fr auto;background:var(--card);border-radius:20px;overflow:hidden;border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow)}

Â  Â  .modal header{position:sticky;top:0;background:rgba(18,25,54,.85);border-bottom:1px solid rgba(255,255,255,.06);padding:8px 12px}

Â  Â  .modal .hdr{display:flex;align-items:center;justify-content:space-between;gap:10px}

Â  Â  .modal .hdr-left{display:flex;gap:8px;align-items:center}

Â  Â  .modal .timer{font-weight:700;padding:4px 8px;border-radius:10px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.1);min-width:74px;text-align:center}

Â  Â  .modal .body{padding:0;overflow:auto;background:#0b112d}

Â  Â  .modal iframe{display:block;width:100%;height:72vh;border:0;background:#0b112d}

Â  Â  .modal footer{padding:10px 12px;display:flex;gap:10px;justify-content:space-between;align-items:center}

Â  Â  .soft{color:var(--muted);font-size:12px}

Â  Â  /* Toast + Confetti */

Â  Â  .toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:#121936;border:1px solid rgba(255,255,255,.12);padding:10px 14px;border-radius:12px;color:var(--text);box-shadow:var(--shadow);opacity:0;pointer-events:none;transition:opacity .25s}

Â  Â  .toast.show{opacity:1}

Â  Â  .confetti{pointer-events:none;position:fixed;inset:0;overflow:hidden;z-index:9999}

Â  Â  .confetti i{position:absolute;width:8px;height:14px;background:linear-gradient(180deg,var(--accent),var(--accent-2));opacity:.9;will-change:transform,opacity}

Â  Â  @keyframes fall{to{transform:translateY(105vh) rotate(360deg);opacity:0}}

Â  </style>

</head>

<body>

Â  <header>

Â  Â  <div class="container nav">

Â  Â  Â  <div class="brand">

Â  Â  Â  Â  <div class="logo" aria-hidden="true"></div>

Â  Â  Â  Â  <div>LinguaLab</div>

Â  Â  Â  Â  <span class="pill">AI English Practice</span>

Â  Â  Â  </div>

Â  Â  Â  <div class="row">

Â  Â  Â  Â  <input id="studentName" class="input" placeholder="Your name (for points & streak)" />

Â  Â  Â  Â  <button class="btn secondary" id="saveNameBtn">Save</button>

Â  Â  Â  </div>

Â  Â  </div>

Â  </header>

Â  <section class="hero">

Â  Â  <div class="container hero-grid">

Â  Â  Â  <div class="card pad">

Â  Â  Â  Â  <h1>Practice real-life English with AI</h1>

Â  Â  Â  Â  <p class="sub">Pick a scenario, practice for ~10 minutes, and mark it completed to earn points. Keep your streak going!</p>

Â  Â  Â  Â  <div class="stats">

Â  Â  Â  Â  Â  <div class="stat"><div class="big" id="points">0</div><div class="cap">Points</div></div>

Â  Â  Â  Â  Â  <div class="stat"><div class="big" id="streak">0</div><div class="cap">Day Streak</div></div>

Â  Â  Â  Â  Â  <div class="stat"><div class="big" id="completed">0</div><div class="cap">Scenarios Done</div></div>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div style="margin-top:16px">

Â  Â  Â  Â  Â  <div class="progress" aria-label="Level progress"><span id="levelBar" style="width:0%"></span></div>

Â  Â  Â  Â  Â  <div class="row" style="justify-content:space-between; margin-top:8px;">

Â  Â  Â  Â  Â  Â  <span class="notice">Level <b id="level">1</b></span>

Â  Â  Â  Â  Â  Â  <span class="notice">Next level at <b id="nextLevelAt">100</b> pts</span>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="panel" style="margin-top:16px">

Â  Â  Â  Â  Â  <div class="row">

Â  Â  Â  Â  Â  Â  <button class="btn" id="resumeBtn">Resume last scenario</button>

Â  Â  Â  Â  Â  Â  <button class="btn ghost" id="resetBtn" title="Reset local progress only">Reset progress</button>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <span class="notice">Progress is saved on this device only (MVP). Use HTTPS + Chrome for mic.</span>

Â  Â  Â  Â  </div>

Â  Â  Â  </div>

Â  Â  Â  <!-- Challenges -->

Â  Â  Â  <div class="card pad">

Â  Â  Â  Â  <h3 style="margin:6px 0 10px">Challenges</h3>

Â  Â  Â  Â  <div id="challenges" class="panel" style="gap:10px">

Â  Â  Â  Â  Â  <div class="row" style="justify-content:space-between">

Â  Â  Â  Â  Â  Â  <div>

Â  Â  Â  Â  Â  Â  Â  <b>Daily</b>: Finish any scenario <span class="soft">(bonus +20)</span>

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="dailyStatus" class="pill">Not done</div>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="row" style="justify-content:space-between">

Â  Â  Â  Â  Â  Â  <div>

Â  Â  Â  Â  Â  Â  Â  <b>Weekly</b>: Complete 5 different scenarios <span class="soft">(bonus +100)</span>

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="weeklyStatus" class="pill">0 / 5</div>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="soft">Bonuses are added automatically when you click â€œMark Completedâ€.</div>

Â  Â  Â  Â  </div>

Â  Â  Â  </div>

Â  Â  </div>

Â  </section>

Â  <section class="scenarios">

Â  Â  <div class="container">

Â  Â  Â  <div class="section-title"><h2 style="margin:0">Daily English (5)</h2></div>

Â  Â  Â  <div class="grid">

Â  Â  Â  Â  <div class="card scenario" data-scenario="ordering">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ</div>

Â  Â  Â  Â  Â  <h3>Ordering Food</h3>

Â  Â  Â  Â  Â  <p>Order food & drinks, ask for recommendations, confirm the bill.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="appointment">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ“…</div>

Â  Â  Â  Â  Â  <h3>Making an Appointment</h3>

Â  Â  Â  Â  Â  <p>Book, confirm or reschedule a clinic/salon/business appointment.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="telephone">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ“</div>

Â  Â  Â  Â  Â  <h3>Telephone Talk</h3>

Â  Â  Â  Â  Â  <p>Ask for someone, clarify on a bad line, confirm details.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="travel">

Â  Â  Â  Â  Â  <div class="thumb">âœˆï¸</div>

Â  Â  Â  Â  Â  <h3>Travel</h3>

Â  Â  Â  Â  Â  <p>Flights, hotels, baggage, cancellations, itinerary & changes.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="smalltalks">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ’¬</div>

Â  Â  Â  Â  Â  <h3>Small Talks</h3>

Â  Â  Â  Â  Â  <p>Open questions, reconnect, light topics, polite closing.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  </div>

Â  Â  Â  <div class="section-title" style="margin-top:26px;"><h2 style="margin:0">Workplace English (5)</h2></div>

Â  Â  Â  <div class="grid">

Â  Â  Â  Â  <div class="card scenario" data-scenario="interview">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ’¼</div>

Â  Â  Â  Â  Â  <h3>Interview</h3>

Â  Â  Â  Â  Â  <p>STAR answers, strengths, value-add, pressure & mistakes.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="negotiating">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ¤</div>

Â  Â  Â  Â  Â  <h3>Negotiating</h3>

Â  Â  Â  Â  Â  <p>Proposals, counters, meet-in-the-middle, polite rejection.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="networking">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ§‘â€ğŸ¤â€ğŸ§‘</div>

Â  Â  Â  Â  Â  <h3>Networking</h3>

Â  Â  Â  Â  Â  <p>Open questions, highlights, plans, swap contacts.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="presentation">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ¤</div>

Â  Â  Â  Â  Â  <h3>Presentation (Signposting)</h3>

Â  Â  Â  Â  Â  <p>Openers, transitions, examples, clear close.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card scenario" data-scenario="prospects">

Â  Â  Â  Â  Â  <div class="thumb">ğŸ“ˆ</div>

Â  Â  Â  Â  Â  <h3>Talking to Prospects</h3>

Â  Â  Â  Â  Â  <p>Discovery, objections, and next steps with a buyer.</p>

Â  Â  Â  Â  </div>

Â  Â  Â  </div>

Â  Â  </div>

Â  </section>

Â  <!-- Modal with embedded Voiceflow -->

Â  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle">

Â  Â  <div class="modal">

Â  Â  Â  <header>

Â  Â  Â  Â  <div class="container hdr">

Â  Â  Â  Â  Â  <div class="hdr-left">

Â  Â  Â  Â  Â  Â  <strong id="modalTitle">Scenario</strong>

Â  Â  Â  Â  Â  Â  <span id="scenarioBadge" class="pill"></span>

Â  Â  Â  Â  Â  Â  <span id="timer" class="timer">10:00</span>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="row">

Â  Â  Â  Â  Â  Â  <button class="btn secondary" id="closeModalBtn">Close</button>

Â  Â  Â  Â  Â  Â  <button class="btn" id="markCompleteBtn" disabled title="Enabled after practice time">Mark Completed</button>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>

Â  Â  Â  </header>

Â  Â  Â  <div class="body">

Â  Â  Â  Â  <iframe id="vfFrame" src="about:blank" allow="microphone; clipboard-read; clipboard-write;" title="Voiceflow Chat"></iframe>

Â  Â  Â  </div>

Â  Â  Â  <footer>

Â  Â  Â  Â  <span class="soft">Tip: If the mic is missing, check browser permissions.</span>

Â  Â  Â  </footer>

Â  Â  </div>

Â  </div>

Â  <!-- Toast + Confetti -->

Â  <div id="toast" class="toast" role="status" aria-live="polite"></div>

Â  <div id="confetti" class="confetti" aria-hidden="true"></div>

Â  <footer class="site">

Â  Â  <div class="container">Built as an MVP for English centers. Â© <span id="year"></span> LinguaLab.</div>

Â  </footer>

Â  <script>

Â  Â  // ============================

Â  Â  // ğŸ”§ Voiceflow project IDs

Â  Â  // ============================

Â  Â  const VF_PROJECT = {

Â  Â  Â  ordering: '68985df43b90d9d386b3e573',

Â  Â  Â  appointment: '689af5bc3b90d9d386b4b06f',

Â  Â  Â  telephone: '689af8fe3b90d9d386b4b1c9',

Â  Â  Â  travel: '689b05df3b90d9d386b4b87f',

Â  Â  Â  smalltalks: '689b0e5c3b90d9d386b4ba66',

Â  Â  Â  interview: '689b2fa13b90d9d386b4c4f5',

Â  Â  Â  negotiating: '689b32823b90d9d386b4c5e2',

Â  Â  Â  networking: '689b35373b90d9d386b4c76a',

Â  Â  Â  presentation:'689b376e9f2f40a7aa3ea337',

Â  Â  Â  prospects: '689b3ef19f2f40a7aa3ea834',

Â  Â  };

Â  Â  // ============================

Â  Â  // âš™ï¸ Config

Â  Â  // ============================

Â  Â  const POINTS_PER_COMPLETION = 50;

Â  Â  const GATE_SECONDS = 240; // 4 minutes before "Mark Completed" auto-enables

Â  Â  const SESSION_SECONDS = 600; // 10 minute soft timer

Â  Â  const DAILY_BONUS = 20;

Â  Â  const WEEKLY_BONUS = 100;

Â  Â  const WEEK_TARGET = 5;

Â  Â  // ============================

Â  Â  // ğŸ§  Local state

Â  Â  // ============================

Â  Â  const state = {

Â  Â  Â  name: localStorage.getItem('ll_name') || '',

Â  Â  Â  points: Number(localStorage.getItem('ll_points') || 0),

Â  Â  Â  completedCount: Number(localStorage.getItem('ll_completed') || 0),

Â  Â  Â  lastScenario: localStorage.getItem('ll_lastScenario') || '',

Â  Â  Â  lastActiveDate: localStorage.getItem('ll_lastDate') || '',

Â  Â  Â  streak: Number(localStorage.getItem('ll_streak') || 0),

Â  Â  Â  sessionStart: 0,

Â  Â  Â  timerId: null,

Â  Â  };

Â  Â  // Level math

Â  Â  function pointsForLevel(level){ if (level<=1) return 0; let total=0, base=100; for(let i=1;i<level;i++){ total+=base; base=Math.round(base*1.2);} return total; }

Â  Â  function currentLevel(points){ let L=1; while(points>=pointsForLevel(L+1)) L++; return L; }

Â  Â  // UI refs

Â  Â  const el = {

Â  Â  Â  points: document.getElementById('points'),

Â  Â  Â  streak: document.getElementById('streak'),

Â  Â  Â  completed: document.getElementById('completed'),

Â  Â  Â  level: document.getElementById('level'),

Â  Â  Â  levelBar: document.getElementById('levelBar'),

Â  Â  Â  nextLevelAt: document.getElementById('nextLevelAt'),

Â  Â  Â  resumeBtn: document.getElementById('resumeBtn'),

Â  Â  Â  resetBtn: document.getElementById('resetBtn'),

Â  Â  Â  saveNameBtn: document.getElementById('saveNameBtn'),

Â  Â  Â  nameInput: document.getElementById('studentName'),

Â  Â  Â  year: document.getElementById('year'),

Â  Â  Â  // modal

Â  Â  Â  backdrop: document.getElementById('modalBackdrop'),

Â  Â  Â  title: document.getElementById('modalTitle'),

Â  Â  Â  badge: document.getElementById('scenarioBadge'),

Â  Â  Â  frame: document.getElementById('vfFrame'),

Â  Â  Â  closeBtn: document.getElementById('closeModalBtn'),

Â  Â  Â  markBtn: document.getElementById('markCompleteBtn'),

Â  Â  Â  timer: document.getElementById('timer'),

Â  Â  Â  // challenges

Â  Â  Â  dailyStatus: document.getElementById('dailyStatus'),

Â  Â  Â  weeklyStatus: document.getElementById('weeklyStatus'),

Â  Â  Â  // toast/confetti

Â  Â  Â  toast: document.getElementById('toast'),

Â  Â  Â  confetti: document.getElementById('confetti'),

Â  Â  };

Â  Â  function fmtDate(d){ return d.toISOString().slice(0,10); }

Â  Â  function pad(n){ return String(n).padStart(2,'0'); }

Â  Â  // Persist

Â  Â  function persist(){

Â  Â  Â  localStorage.setItem('ll_name', state.name);

Â  Â  Â  localStorage.setItem('ll_points', String(state.points));

Â  Â  Â  localStorage.setItem('ll_completed', String(state.completedCount));

Â  Â  Â  localStorage.setItem('ll_lastScenario', state.lastScenario);

Â  Â  Â  localStorage.setItem('ll_lastDate', state.lastActiveDate);

Â  Â  Â  localStorage.setItem('ll_streak', String(state.streak));

Â  Â  }

Â  Â  // Render header stats

Â  Â  function render(){

Â  Â  Â  el.points.textContent = state.points;

Â  Â  Â  el.streak.textContent = state.streak;

Â  Â  Â  el.completed.textContent = state.completedCount;

Â  Â  Â  const lvl = currentLevel(state.points);

Â  Â  Â  el.level.textContent = lvl;

Â  Â  Â  const next = pointsForLevel(lvl+1), prev = pointsForLevel(lvl);

Â  Â  Â  el.nextLevelAt.textContent = next;

Â  Â  Â  const width = Math.max(2, Math.min(100, Math.round(((state.points - prev)/(next - prev))*100)));

Â  Â  Â  el.levelBar.style.width = width + '%';

Â  Â  Â  el.resumeBtn.disabled = !state.lastScenario;

Â  Â  Â  el.year.textContent = new Date().getFullYear();

Â  Â  Â  el.nameInput.value = state.name;

Â  Â  Â  renderChallenges();

Â  Â  }

Â  Â  // ğŸ”¥ Streak

Â  Â  function updateStreakOnActivity(){

Â  Â  Â  const today = fmtDate(new Date());

Â  Â  Â  if (!state.lastActiveDate){ state.streak = 1; }

Â  Â  Â  else {

Â  Â  Â  Â  const diff = Math.round((new Date(today) - new Date(state.lastActiveDate))/(1000*60*60*24));

Â  Â  Â  Â  if (diff === 1) state.streak += 1;

Â  Â  Â  Â  else if (diff > 1) state.streak = 1;

Â  Â  Â  }

Â  Â  Â  state.lastActiveDate = today;

Â  Â  }

Â  Â  // ===== Challenges (local-only) =====

Â  Â  function weekStartStr(d=new Date()){

Â  Â  Â  const dt = new Date(d);

Â  Â  Â  const day = (dt.getDay()+6)%7; // Monday=0

Â  Â  Â  dt.setHours(0,0,0,0);

Â  Â  Â  dt.setDate(dt.getDate()-day);

Â  Â  Â  return dt.toISOString().slice(0,10);

Â  Â  }

Â  Â  function getWeekSet(){

Â  Â  Â  const id = weekStartStr();

Â  Â  Â  const key = 'll_weekSet_'+id;

Â  Â  Â  const raw = localStorage.getItem(key);

Â  Â  Â  return { id, key, set: new Set(raw ? JSON.parse(raw) : []) };

Â  Â  }

Â  Â  function setWeekSet(ws){

Â  Â  Â  localStorage.setItem(ws.key, JSON.stringify([...ws.set]));

Â  Â  }

Â  Â  function weeklyAwarded(){

Â  Â  Â  const id = weekStartStr();

Â  Â  Â  return localStorage.getItem('ll_weekAwarded_'+id) === '1';

Â  Â  }

Â  Â  function setWeeklyAwarded(){

Â  Â  Â  const id = weekStartStr();

Â  Â  Â  localStorage.setItem('ll_weekAwarded_'+id, '1');

Â  Â  }

Â  Â  function dailyAwardedToday(){

Â  Â  Â  const today = fmtDate(new Date());

Â  Â  Â  return localStorage.getItem('ll_dailyBonusDate') === today;

Â  Â  }

Â  Â  function setDailyAwardedToday(){

Â  Â  Â  const today = fmtDate(new Date());

Â  Â  Â  localStorage.setItem('ll_dailyBonusDate', today);

Â  Â  }

Â  Â  function renderChallenges(){

Â  Â  Â  el.dailyStatus.textContent = dailyAwardedToday() ? 'Done âœ“' : 'Not done';

Â  Â  Â  const ws = getWeekSet();

Â  Â  Â  const count = ws.set.size;

Â  Â  Â  el.weeklyStatus.textContent = (weeklyAwarded() ? 'Completed âœ“' : `${count} / ${WEEK_TARGET}`);

Â  Â  }

Â  Â  // ===== Modal: Voiceflow loader (embedded) =====

Â  Â  function recreateVFFrame() {

Â  Â  Â  const old = el.frame;

Â  Â  Â  const fresh = document.createElement('iframe');

Â  Â  Â  fresh.id = 'vfFrame';

Â  Â  Â  fresh.title = 'Voiceflow Chat';

Â  Â  Â  fresh.src = 'about:blank';

Â  Â  Â  fresh.setAttribute('allow', 'microphone; clipboard-read; clipboard-write;');

Â  Â  Â  old.parentNode.replaceChild(fresh, old);

Â  Â  Â  el.frame = fresh;

Â  Â  Â  return fresh;

Â  Â  }

Â  Â  function loadVFInIframe(projectID){

Â  Â  Â  const doc = el.frame.contentWindow.document;

Â  Â  Â  const html = `

<!DOCTYPE html><html><head>

<meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />

<style>

Â  html,body{margin:0;height:100%;background:#0b112d;color:#e6e9f7;font-family:Inter,system-ui,Arial}

Â  .vfrc-launcher{display:none !important;}

Â  .vfrc-widget{

Â  Â  position: static !important; inset:auto !important;

Â  Â  margin:18px auto !important; box-shadow:none !important;

Â  Â  width:min(900px,96%) !important; height:calc(100vh - 36px) !important;

Â  Â  border-radius:16px !important;

Â  }

Â  .vfrc-chat,.vfrc-widget__container{height:100% !important; max-height:none !important;}

</style>

</head><body>

<script type="text/javascript">

(function(d,t){

Â  var v=d.createElement(t);

Â  v.type="text/javascript";

Â  v.src="https://cdn.voiceflow.com/widget-next/bundle.mjs";

Â  v.onload=function(){

Â  Â  try{

Â  Â  Â  window.voiceflow.chat.load({

Â  Â  Â  Â  verify:{ projectID:"${projectID}" },

Â  Â  Â  Â  url:"https://general-runtime.voiceflow.com",

Â  Â  Â  Â  versionID:"production",

Â  Â  Â  Â  voice:{ url:"https://runtime-api.voiceflow.com" }

Â  Â  Â  });

Â  Â  Â  window.voiceflow.chat.open?.();

Â  Â  Â  setTimeout(()=>window.voiceflow.chat.open?.(), 600);

Â  Â  }catch(e){ console.error(e); }

Â  };

Â  (d.head||d.body).appendChild(v);

})(document,"script");

<\/script>

</body></html>`;

Â  Â  Â  doc.open(); doc.write(html); doc.close();

Â  Â  }

Â  Â  const scenarioMeta = {

Â  Â  Â  ordering: { title:'Ordering Food', badge:'Daily' },

Â  Â  Â  appointment: { title:'Making an Appointment', badge:'Daily' },

Â  Â  Â  telephone: { title:'Telephone Talk', badge:'Daily' },

Â  Â  Â  travel: { title:'Travel', badge:'Daily' },

Â  Â  Â  smalltalks: { title:'Small Talks', badge:'Daily' },

Â  Â  Â  interview: { title:'Interview', badge:'Workplace' },

Â  Â  Â  negotiating: { title:'Negotiating', badge:'Workplace' },

Â  Â  Â  networking: { title:'Networking', badge:'Workplace' },

Â  Â  Â  presentation:{ title:'Presentation (Signposting)', badge:'Workplace' },

Â  Â  Â  prospects: { title:'Talking to Prospects', badge:'Workplace' },

Â  Â  };

Â  Â  // Timer + gating

Â  Â  function startTimer(){

Â  Â  Â  stopTimer();

Â  Â  Â  state.sessionStart = Date.now();

Â  Â  Â  el.markBtn.disabled = true;

Â  Â  Â  tickTimer();

Â  Â  Â  state.timerId = setInterval(tickTimer, 1000);

Â  Â  }

Â  Â  function stopTimer(){

Â  Â  Â  if (state.timerId){ clearInterval(state.timerId); state.timerId = null; }

Â  Â  }

Â  Â  function secondsSinceStart(){

Â  Â  Â  if (!state.sessionStart) return 0;

Â  Â  Â  return Math.floor((Date.now() - state.sessionStart) / 1000);

Â  Â  }

Â  Â  function tickTimer(){

Â  Â  Â  const elapsed = secondsSinceStart();

Â  Â  Â  const remain = Math.max(0, SESSION_SECONDS - elapsed);

Â  Â  Â  el.timer.textContent = `${pad(Math.floor(remain/60))}:${pad(remain%60)}`;

Â  Â  Â  const canComplete = elapsed >= GATE_SECONDS; // â† strictly time-gated

Â  Â  Â  el.markBtn.disabled = !canComplete;

Â  Â  }

Â  Â  // Open/close scenario

Â  Â  function openScenario(key){

Â  Â  Â  const meta = scenarioMeta[key];

Â  Â  Â  const id = VF_PROJECT[key];

Â  Â  Â  if (!meta || !id) return;

Â  Â  Â  state.lastScenario = key; persist();

Â  Â  Â  el.title.textContent = meta.title;

Â  Â  Â  el.badge.textContent = meta.badge;

Â  Â  Â  el.backdrop.style.display = 'flex';

Â  Â  Â  recreateVFFrame();

Â  Â  Â  loadVFInIframe(id);

Â  Â  Â  startTimer();

Â  Â  Â  updateStreakOnActivity(); persist(); render();

Â  Â  }

Â  Â  function closeModal(){

Â  Â  Â  el.backdrop.style.display = 'none';

Â  Â  Â  stopTimer();

Â  Â  }

Â  Â  // Toast + confetti

Â  Â  function showToast(msg){

Â  Â  Â  el.toast.textContent = msg;

Â  Â  Â  el.toast.classList.add('show');

Â  Â  Â  setTimeout(()=> el.toast.classList.remove('show'), 1600);

Â  Â  }

Â  Â  function burstConfetti(){

Â  Â  Â  const c = el.confetti;

Â  Â  Â  c.innerHTML = '';

Â  Â  Â  const N = 80;

Â  Â  Â  for (let i=0;i<N;i++){

Â  Â  Â  Â  const p = document.createElement('i');

Â  Â  Â  Â  const left = Math.random()*100;

Â  Â  Â  Â  const dur = 0.9 + Math.random()*0.8;

Â  Â  Â  Â  const delay = Math.random()*0.2;

Â  Â  Â  Â  const rotate = Math.random()*360;

Â  Â  Â  Â  p.style.left = left+'vw';

Â  Â  Â  Â  p.style.top = '-20px';

Â  Â  Â  Â  p.style.transform = `rotate(${rotate}deg)`;

Â  Â  Â  Â  p.style.animation = `fall ${dur}s cubic-bezier(.2,.7,.2,1) ${delay}s forwards`;

Â  Â  Â  Â  if (Math.random()<.33) p.style.background = 'linear-gradient(180deg,#FFD66E,#FF8BA7)';

Â  Â  Â  Â  else if (Math.random()<.66) p.style.background = 'linear-gradient(180deg,#8EF0D0,#6E9CFF)';

Â  Â  Â  Â  c.appendChild(p);

Â  Â  Â  }

Â  Â  Â  setTimeout(()=>{ c.innerHTML=''; }, 1800);

Â  Â  }

Â  Â  // Points awarding (with streak bonus + challenges)

Â  Â  function markCompleted(){

Â  Â  Â  if (el.markBtn.disabled) return;

Â  Â  Â  const base = POINTS_PER_COMPLETION;

Â  Â  Â  const mult = Math.min(2, 1 + 0.1 * (state.streak - 1)); // cap x2

Â  Â  Â  const streakPct = Math.round((mult - 1) * 100);

Â  Â  Â  let gained = Math.round(base * mult);

Â  Â  Â  if (!dailyAwardedToday()){

Â  Â  Â  Â  gained += DAILY_BONUS;

Â  Â  Â  Â  setDailyAwardedToday();

Â  Â  Â  }

Â  Â  Â  const ws = getWeekSet();

Â  Â  Â  ws.set.add(state.lastScenario);

Â  Â  Â  setWeekSet(ws);

Â  Â  Â  if (!weeklyAwarded() && ws.set.size >= WEEK_TARGET){

Â  Â  Â  Â  gained += WEEKLY_BONUS;

Â  Â  Â  Â  setWeeklyAwarded();

Â  Â  Â  }

Â  Â  Â  state.points += gained;

Â  Â  Â  state.completedCount += 1;

Â  Â  Â  persist(); render();

Â  Â  Â  burstConfetti();

Â  Â  Â  showToast(`Session saved! +${gained} pts${streakPct>0?` (streak bonus +${streakPct}%)`:''}`);

Â  Â  Â  setTimeout(closeModal, 1100);

Â  Â  }

Â  Â  // Reset + name save

Â  Â  function resetProgress(){

Â  Â  Â  if (!confirm('Reset local progress (points, streak, completed, challenges)?')) return;

Â  Â  Â  state.points = 0; state.completedCount = 0; state.streak = 0; state.lastActiveDate = '';

Â  Â  Â  localStorage.removeItem('ll_dailyBonusDate');

Â  Â  Â  const id = weekStartStr();

Â  Â  Â  localStorage.removeItem('ll_weekSet_'+id);

Â  Â  Â  localStorage.removeItem('ll_weekAwarded_'+id);

Â  Â  Â  persist(); render();

Â  Â  Â  showToast('Progress reset');

Â  Â  }

Â  Â  function saveName(){

Â  Â  Â  state.name = (el.nameInput.value || '').trim(); persist();

Â  Â  Â  showToast('Saved âœ“');

Â  Â  }

Â  Â  // Events

Â  Â  document.querySelectorAll('.scenario').forEach(card => {

Â  Â  Â  card.addEventListener('click', ()=> openScenario(card.dataset.scenario));

Â  Â  });

Â  Â  el.closeBtn.addEventListener('click', closeModal);

Â  Â  el.markBtn.addEventListener('click', markCompleted);

Â  Â  el.resetBtn.addEventListener('click', resetProgress);

Â  Â  el.saveNameBtn.addEventListener('click', saveName);

Â  Â  el.resumeBtn.addEventListener('click', ()=> state.lastScenario && openScenario(state.lastScenario));

Â  Â  // Init

Â  Â  document.getElementById('year').textContent = new Date().getFullYear();

Â  Â  render();

Â  </script>

</body>

</html>
